<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="EcoSentinel AI - Community-Driven Environmental Risk Intelligence Platform">
    <meta name="keywords" content="environmental intelligence, climate action, Kenya, UNEP, AI, flooding, air quality, deforestation">
    <meta name="author" content="Gideon Kiprono">
    <title>EcoSentinel AI - Environmental Risk Intelligence Platform</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Azure Maps SDK -->
    <link rel="stylesheet" href="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.css" type="text/css">
    <script src="https://atlas.microsoft.com/sdk/javascript/mapcontrol/2/atlas.min.js"></script>
    
    <!-- Chart.js for data visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
      :root {
        /* EcoSentinel AI Brand Colors */
        --forest-green: #2E7D32;
        --eco-green: #4CAF50;
        --nature-green: #388E3C;
        --tech-blue: #00BCD4;
        --alert-orange: #FF9800;
        --deep-blue: #1976D2;
        --earth-red: #F44336;
        --dark-forest: #1B5E20;
        --light-green: #E8F5E8;
        --sage: #C8E6C9;
        --gray: #757575;
        --light-gray: #F5F5F5;
        --white: #FFFFFF;
        
        /* Layout */
        --header-height: 64px;
        --border-radius: 12px;
        --shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        
        /* Animation */
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Inter', Arial, sans-serif;
        background: var(--light-gray);
        color: #333;
        overflow-x: hidden;
      }

      /* Modern Header */
      .header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--header-height);
        background: white;
        box-shadow: var(--shadow);
        z-index: 1000;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 24px;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .logo {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .logo-icon {
        width: 32px;
        height: 32px;
        background: var(--forest-green);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
      }

      .logo-text {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 20px;
        font-weight: 700;
        color: #333;
      }

      .header-nav {
        display: flex;
        align-items: center;
        gap: 32px;
        margin-left: 48px;
      }

      .nav-item {
        text-decoration: none;
        color: #555;
        font-weight: 500;
        position: relative;
        padding: 8px 4px;
      }

      .nav-item.active {
        color: var(--forest-green);
      }

      .nav-item.active::after {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 2px;
        background: var(--forest-green);
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .phone-number {
        font-size: 14px;
        color: #666;
      }

      /* Main Layout */
      .main-container {
        margin-top: var(--header-height);
        display: flex;
        min-height: calc(100vh - var(--header-height));
      }

      .content-column {
        width: 400px;
        background: white;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .map-column {
        flex: 1;
        position: relative;
      }

      .map-container {
        height: 100%;
        width: 100%;
      }

      /* Chat Interface */
      .chat-container {
        display: flex;
        flex-direction: column;
        background: white;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow);
        overflow: hidden;
      }

      .chat-header {
        padding: 12px 16px;
        background: white;
        border-bottom: 1px solid #eee;
        font-weight: 600;
      }

      .chat-messages {
        flex: 1;
        padding: 16px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        gap: 16px;
        min-height: 240px;
        max-height: 320px;
      }

      .message {
        max-width: 85%;
        padding: 12px 16px;
        border-radius: 18px;
        font-size: 14px;
        line-height: 1.4;
      }

      .message.user {
        align-self: flex-end;
        background: var(--tech-blue);
        color: white;
        border-bottom-right-radius: 4px;
      }

      .message.assistant {
        align-self: flex-start;
        background: #f0f0f0;
        color: #333;
        border-bottom-left-radius: 4px;
      }

      .message-question {
        display: inline-block;
        background: var(--dark-forest);
        color: white;
        padding: 8px 16px;
        border-radius: 20px;
        margin: 6px 0;
        font-size: 14px;
        cursor: pointer;
      }

      .chat-input-container {
        padding: 12px 16px;
        border-top: 1px solid #eee;
        display: flex;
        gap: 12px;
      }

      .chat-input {
        flex: 1;
        padding: 10px 16px;
        border: 1px solid #ddd;
        border-radius: 20px;
        outline: none;
        transition: var(--transition);
      }

      .chat-input:focus {
        border-color: var(--tech-blue);
        box-shadow: 0 0 0 2px rgba(0, 188, 212, 0.2);
      }

      .chat-send {
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--tech-blue);
        color: white;
        border: none;
        border-radius: 50%;
        cursor: pointer;
      }

      /* Alerts Section */
      .alerts-section {
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .section-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 4px;
      }

      .alert-item {
        background: #FEE8E8;
        border-left: 4px solid var(--earth-red);
        padding: 16px;
        border-radius: 8px;
      }

      .alert-item.warning {
        background: #FFF3E0;
        border-left-color: var(--alert-orange);
      }

      .alert-title {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        margin-bottom: 8px;
        color: var(--earth-red);
      }

      .alert-item.warning .alert-title {
        color: var(--alert-orange);
      }

      .alert-content {
        font-size: 14px;
      }

      .air-quality-gauge {
        text-align: center;
        margin: 12px 0;
      }

      .gauge-value {
        font-size: 20px;
        font-weight: 700;
      }

      /* Dashboard Section */
      .dashboard-section {
        border-radius: var(--border-radius);
        background: white;
        padding: 20px;
        box-shadow: var(--shadow);
      }

      .chart-container {
        height: 220px;
      }

      /* Legend */
      .chart-legend {
        display: flex;
        justify-content: center;
        gap: 24px;
        margin-top: 12px;
      }

      .legend-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
      }

      .legend-color {
        width: 12px;
        height: 12px;
        border-radius: 2px;
      }

      /* Responsive Design */
      @media (max-width: 1024px) {
        .main-container {
          flex-direction: column;
        }
        
        .content-column {
          width: 100%;
          height: auto;
        }
        
        .map-column {
          height: 400px;
        }
      }

      @media (max-width: 768px) {
        .header-nav {
          display: none;
        }
        
        .phone-number {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <div class="logo">
          <div class="logo-icon">
            <i class="fas fa-leaf"></i>
          </div>
          <div class="logo-text">EcoSentinel AI</div>
        </div>
        <nav class="header-nav">
          <a href="#" class="nav-item active">Chat</a>
          <a href="#" class="nav-item">Alerts</a>
          <a href="#" class="nav-item">About</a>
        </nav>
      </div>
      <div class="header-right">
        <div class="phone-number">+254-712.345678</div>
        <div class="language-toggle">
          <button id="lang-en" class="lang-btn active">EN</button>
          <button id="lang-sw" class="lang-btn">SW</button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-container">
      <!-- Left Column - Chat & Alerts -->
      <div class="content-column">
        <!-- Chat Interface -->
        <div class="chat-container">
          <div class="chat-header">Hello! How can I assist you today?</div>
          <div class="chat-messages" id="chatMessages">
            <div class="message-question">Which trees are best for planting in Kibera?</div>
            <div class="message assistant">
              For planting in Kibera: I recommend native Acacia trees such as Acacia xanthophloea. They can help reduce flooding and improve soil quality.
            </div>
            <div class="message user">
              Jane: Text me today's air quality →
            </div>
          </div>
          <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" placeholder="Ask about environmental risks in your area...">
            <button class="chat-send" id="chatSend">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
        
        <!-- Alerts Section -->
        <div class="alerts-section">
          <h3 class="section-title">Alerts</h3>
          
          <div class="alert-item">
            <div class="alert-title">
              <i class="fas fa-exclamation-triangle"></i>
              Flood risk in Kawangware
            </div>
            <div class="alert-content">
              Evacuate low-lying areas immediately
            </div>
          </div>
          
          <div class="alert-item warning">
            <div class="alert-title">
              <i class="fas fa-wind"></i>
              Today's air quality Forecast: → Mathare
            </div>
            <div class="alert-content">
              Take precautions (AQI = 164)
            </div>
            <div class="air-quality-gauge">
              <img src="https://via.placeholder.com/300x100/FFFFFF/888888?text=AQI+Gauge" alt="Air Quality Gauge" style="max-width: 100%; height: auto;">
              <div class="gauge-value">UNSAFE</div>
            </div>
          </div>
        </div>
        
        <!-- Dashboard Section -->
        <div class="dashboard-section">
          <h3 class="section-title">Planting & Pollution Alerts</h3>
          <div class="chart-container">
            <canvas id="environmentalChart"></canvas>
          </div>
          <div class="chart-legend">
            <div class="legend-item">
              <div class="legend-color" style="background-color: #1B5E20;"></div>
              <span>Planting</span>
            </div>
            <div class="legend-item">
              <div class="legend-color" style="background-color: #4CAF50;"></div>
              <span>Pollution alerts</span>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Right Column - Map -->
      <div class="map-column">
        <div id="mapContainer" class="map-container"></div>
      </div>
    </main>

    <!-- Scripts -->
    <script type="module" src="/src/index.ts"></script>
    <script>
      // Language configurations
      const languages = {
        en: {
          greeting: 'Hello! How can I assist you today?',
          chatPlaceholder: 'Ask about environmental risks in your area...',
          alertsTitle: 'Alerts',
          floodAlert: 'Flood risk in Kawangware',
          evacuateMessage: 'Evacuate low-lying areas immediately',
          airQualityTitle: 'Today\'s air quality Forecast:',
          precautionsMessage: 'Take precautions (AQI = 164)',
          dashboardTitle: 'Planting & Pollution Alerts',
          planting: 'Planting',
          pollution: 'Pollution alerts',
          unsafe: 'UNSAFE'
        },
        sw: {
          greeting: 'Hujambo! Nawezaje kukusaidia leo?',
          chatPlaceholder: 'Uliza kuhusu hatari za mazingira eneo lako...',
          alertsTitle: 'Tahadhari',
          floodAlert: 'Hatari ya mafuriko katika Kawangware',
          evacuateMessage: 'Hama maeneo ya chini mara moja',
          airQualityTitle: 'Ubora wa hewa leo:',
          precautionsMessage: 'Chukua tahadhari (AQI = 164)',
          dashboardTitle: 'Upanzi na Tahadhari za Uchafuzi',
          planting: 'Upanzi',
          pollution: 'Tahadhari za uchafuzi',
          unsafe: 'SI SALAMA'
        }
      };

      let currentLanguage = 'en';

      // Language switching
      document.getElementById('lang-en').addEventListener('click', () => switchLanguage('en'));
      document.getElementById('lang-sw').addEventListener('click', () => switchLanguage('sw'));

      function switchLanguage(lang) {
        currentLanguage = lang;
        
        // Update active button
        document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
        document.getElementById(`lang-${lang}`).classList.add('active');
        
        // Update text content with translations
        const texts = languages[lang];
        document.querySelector('.chat-header').textContent = texts.greeting;
        document.getElementById('chatInput').placeholder = texts.chatPlaceholder;
        document.querySelector('.section-title').textContent = texts.alertsTitle;
        document.querySelector('.alert-title').innerHTML = 
          `<i class="fas fa-exclamation-triangle"></i> ${texts.floodAlert}`;
        document.querySelector('.alert-content').textContent = texts.evacuateMessage;
        
        // Update other elements
        const airQualityTitle = document.querySelectorAll('.alert-title')[1];
        airQualityTitle.innerHTML = `<i class="fas fa-wind"></i> ${texts.airQualityTitle} → Mathare`;
        
        document.querySelectorAll('.alert-content')[1].textContent = texts.precautionsMessage;
        document.querySelector('.gauge-value').textContent = texts.unsafe;
        document.querySelectorAll('.section-title')[1].textContent = texts.dashboardTitle;
        
        // Update legend
        document.querySelectorAll('.legend-item span')[0].textContent = texts.planting;
        document.querySelectorAll('.legend-item span')[1].textContent = texts.pollution;
      }

      // Chat functionality
      const chatInput = document.getElementById('chatInput');
      const chatSend = document.getElementById('chatSend');
      const chatMessages = document.getElementById('chatMessages');

      function sendMessage() {
        const message = chatInput.value.trim();
        if (!message) return;

        // Add user message
        const userMsg = document.createElement('div');
        userMsg.className = 'message user';
        userMsg.textContent = message;
        chatMessages.appendChild(userMsg);

        // Clear input
        chatInput.value = '';

        // Simulate AI response
        setTimeout(() => {
          const aiMsg = document.createElement('div');
          aiMsg.className = 'message assistant';
          aiMsg.textContent = generateResponse(message);
          chatMessages.appendChild(aiMsg);
          chatMessages.scrollTop = chatMessages.scrollHeight;
        }, 1000);

        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function generateResponse(message) {
        const responses = {
          en: [
            "Based on current data, the flood risk in your area is moderate. Consider preparing emergency supplies.",
            "Air quality is currently at 156 AQI (Moderate). Sensitive individuals should limit outdoor activities.",
            "The heat index is 28°C. Stay hydrated and seek shade during peak hours.",
            "Forest cover in your region is stable at 92%. Continue supporting conservation efforts.",
            "I can help you understand environmental risks. What specific area or concern would you like to know about?"
          ],
          sw: [
            "Kulingana na data za sasa, hatari ya mafuriko eneo lako ni wastani. Zingatia kujiandaa na vifaa vya dharura.",
            "Ubora wa hewa kwa sasa ni 156 AQI (Wastani). Watu wenye mchocheo wanapaswa kupunguza shughuli za nje.",
            "Kiwango cha joto ni 28°C. Kunywa maji mengi na utafute kivuli wakati wa joto kali.",
            "Mlolongo wa misitu eneo lako ni thabiti kwa 92%. Endelea kuunga mkono juhudi za uhifadhi.",
            "Ninaweza kukusaidia kuelewa hatari za mazingira. Je, ungependa kujua kuhusu eneo gani au jambo la ziada?"
          ]
        };
        
        const langResponses = responses[currentLanguage];
        return langResponses[Math.floor(Math.random() * langResponses.length)];
      }

      chatSend.addEventListener('click', sendMessage);
      chatInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
      });

      // Initialize Azure Maps
      function initializeMap() {
        // Create a map instance
        const map = new atlas.Map('mapContainer', {
          center: [36.8219, -1.2921], // Nairobi coordinates
          zoom: 11,
          style: 'road',
          authOptions: {
            authType: 'subscriptionKey',
            subscriptionKey: 'YOUR_AZURE_MAPS_KEY' // Replace with your Azure Maps key
          }
        });

        // Wait until the map resources are ready
        map.events.add('ready', function() {
          // Add some sample environmental data points
          const locations = [
            [-1.2921, 36.8219, 20, "#4CAF50"], // Nairobi Central
            [-1.2740, 36.8172, 35, "#8BC34A"], // Westlands
            [-1.3098, 36.8537, 15, "#4CAF50"], // Embakasi
            [-1.2699, 36.8566, 25, "#FFC107"], // Mathare
            [-1.3127, 36.7816, 40, "#FF9800"], // Kibera
            [-1.2240, 36.8795, 12, "#4CAF50"]  // Kasarani
          ];
          
          // Create data source and add it to the map
          const dataSource = new atlas.source.DataSource();
          map.sources.add(dataSource);
          
          // Add points to the data source
          for (const location of locations) {
            const point = new atlas.data.Feature(
              new atlas.data.Point([location[1], location[0]]),
              {
                size: location[2],
                color: location[3]
              }
            );
            dataSource.add(point);
          }
          
          // Add a bubble layer to render the points
          map.layers.add(new atlas.layer.BubbleLayer(dataSource, null, {
            radius: ['get', 'size'],
            color: ['get', 'color'],
            opacity: 0.7,
            strokeWidth: 0
          }));
        });
      }

      // Initialize Chart.js chart for environmental data
      function initializeChart() {
        const ctx = document.getElementById('environmentalChart').getContext('2d');
        
        const chartData = {
          labels: ['Apr 21', 'Apr 22', 'Apr 23', 'Apr 24', 'Apr 25', 'Apr 26'],
          datasets: [
            {
              label: 'Planting',
              data: [2, 13, 12, 9, 17, 13],
              borderColor: '#1B5E20',
              backgroundColor: 'rgba(27, 94, 32, 0.1)',
              borderWidth: 2,
              tension: 0.3,
              pointRadius: 0
            },
            {
              label: 'Pollution Alerts',
              data: [1, 3, 2, 8, 10, 3],
              borderColor: '#4CAF50',
              backgroundColor: 'rgba(76, 175, 80, 0.1)',
              borderWidth: 2,
              tension: 0.3,
              pointRadius: 0
            }
          ]
        };
        
        const chartConfig = {
          type: 'line',
          data: chartData,
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false
              },
              tooltip: {
                mode: 'index',
                intersect: false
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                grid: {
                  drawBorder: false
                },
                ticks: {
                  maxTicksLimit: 5
                }
              },
              x: {
                grid: {
                  display: false
                }
              }
            }
          }
        };
        
        new Chart(ctx, chartConfig);
      }

      // Initialize on load
      document.addEventListener('DOMContentLoaded', () => {
        initializeMap();
        initializeChart();
        
        // Add question click handlers
        document.querySelector('.message-question').addEventListener('click', () => {
          chatInput.value = document.querySelector('.message-question').textContent;
          sendMessage();
        });
      });
    </script>
  </body>
</html>
